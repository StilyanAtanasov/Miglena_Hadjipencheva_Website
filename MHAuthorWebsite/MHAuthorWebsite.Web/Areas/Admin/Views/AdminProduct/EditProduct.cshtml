@using MHAuthorWebsite.Web.ViewModels.Product
@using Microsoft.AspNetCore.Mvc.TagHelpers
@using MHAuthorWebsite.Web.Utils
@model EditProductFormViewModel


@{
	ViewData["Title"] = "Редактирай продукт";
}

@section Styles {
	<link rel="stylesheet" href="~/css/input-form.css" asp-append-version="true" />
}

<div class="page-wrapper flex-column">
	<section class="modal-invisible large flex-column">
		<h1 class="title">@ViewData["Title"]</h1>

		<form class="input-form flex-column" asp-area="Admin" asp-controller="AdminProduct" asp-action="EditProduct" asp-route-id="@Model.Id" id="addProductForm" method="post">
			<div class="form-input-box flex-column">
				<label class="form-label" asp-for="Name">Име:</label>
				<input class="form-input" asp-for="Name" />
				<span class="input-error" asp-validation-for="Name" class="text-danger"></span>
			</div>
			<div class="form-input-box flex-column">
				<label class="form-label" asp-for="Description">Описание:</label>
				<textarea class="form-input" asp-for="Description"></textarea>
				<span class="input-error" asp-validation-for="Description" class="text-danger"></span>
			</div>
			<div class="form-input-box flex-column">
				<label class="form-label" asp-for="Price">Цена:</label>
				<input class="form-input" asp-for="Price" type="number" />
				<span class="input-error" asp-validation-for="Price" class="text-danger"></span>
			</div>
			<div class="form-input-box flex-column">
				<label class="form-label" asp-for="StockQuantity">Количество:</label>
				<input class="form-input" asp-for="StockQuantity" type="number" />
				<span class="input-error" asp-validation-for="StockQuantity" class="text-danger"></span>
			</div>
			<div class="form-input-box flex-column select-list">
				<label class="form-label">Категория:</label>
				<p>@Model.ProductTypeName</p>
				<span class="input-error" class="text-danger"></span>
			</div>

			<div id="productTypeAttributesContainer" class="form-input-box flex-column">
				@foreach (AttributeValueForm a in Model.Attributes)
				{
					string inputType = AttributeDataTypeMapper.HtmlInputTypes[a.DataType];
					string containerClass = AttributeDataTypeMapper.CssContainerClass[a.DataType];

					<div class="form-input-box flex-column @containerClass">
						<label class="form-label">@a.Label:</label>

						<input type="@inputType"
							   name="@a.Value"
							   class="form-input"
							   data-val="true"
							   data-val-required="@(a.IsRequired ? $"Полето \"{a.Label}\" е задължително." : null)"
							   style="-webkit-appearance: textarea"
							   value="@a.Value" />

						<input type="hidden" name="@a.Key" value="@a.Key" />
						<input type="hidden" name="@a.Label" value="@a.Label" />
						<span class="input-error"
							  data-valmsg-for="@a.Value"
							  data-valmsg-replace="true"></span>
					</div>
				}
			</div>

			<button type="submit" class="btn submit-btn flex-row">Запази</button>
		</form>
	</section>
</div>